<!doctype html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:url"           content="https://debamitro.github.io/blog/making-videos-with-media-recorder/" />
<meta property="og:type"          content="website" />
<meta property="og:title"         content="Making Videos With MediaRecorder" />
<meta property="og:description"   content="Making Videos With MediaRecorder" />

    <title>
      Making Videos With MediaRecorder
    </title>
        <link rel="stylesheet" type="text/css" href="https://debamitro.github.io//css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="https://debamitro.github.io//css/style.css" />

    <script src="https://debamitro.github.io//js/onready.js"></script>
    <script src="https://debamitro.github.io//js/transformtextnodes.js"></script>
    <script src="https://debamitro.github.io//generate-bangla-utf8-cljs-demo/target/out.js"></script>
    <script>
      ready(transformtextnodes(generate_bangla_utf8_cljs.converter.to_bangla_utf8));
    </script>
        
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TT65MZJG4S"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      
      gtag('config', 'G-TT65MZJG4S');
    </script>


<script>
  async function getPageViews() {
    const pageViewsArea = document.querySelector('#pageViews');
    if (pageViewsArea) {
      try {
        const path = '\/blog\/making-videos-with-media-recorder';
        const finalPath = path.endsWith('/') ? path : path + '/';
        const response = await fetch('https://simple-ga-stats.onrender.com/api/v1?site=debamitro.github.io&page=' + encodeURIComponent(finalPath));
        const data = await response.json();
        if (data.success) {
          pageViewsArea.textContent = data.data[0].sessions + ' views';
        }
      } catch (error) {
        console.error('Error fetching page views:', error);
      }
    }
  }
  
 window.addEventListener('load', getPageViews);
</script>

    
    
    <script src="https://debamitro.github.io//js/external-links.js"></script>
  </head>
  <body>
    
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v22.0"></script>
  
    <div class="my-menu-bar">
  <ul class="my-menu">
    <li class="my-menu-item">
      <a href="https://debamitro.github.io/" class="my-menu-item-link">Home</a>
    </li>
    
    <li class="my-menu-item">
      <a href="/projects/" class="my-menu-item-link">üíª‚öôÔ∏è Projects</a>
    </li>
    
    <li class="my-menu-item">
      <a href="/blog/" class="my-menu-item-link">üìù Blog</a>
    </li>
    
    <li class="my-menu-item">
      <a href="/about/" class="my-menu-item-link">üôãüèª‚Äç‚ôÇÔ∏è About</a>
    </li>
    
    <li class="my-menu-item">
      <a href="https://x.com/debamitro" class="my-menu-item-link" target="_blank"><img src="https://debamitro.github.io//images/x-logo-white.png" /></a>
    </li>
    <li class="my-menu-item">
      <a href="https://github.com/debamitro" class="my-menu-item-link" target="_blank"><img src="https://debamitro.github.io//images/github-mark-white.png" /></a>
    </li>
  </ul>
</div>

    <div class="my-page-container">
      <div class="my-page-head">
        Making Videos With MediaRecorder
      </div>
      <hr />
      <div class="my-page-date">
        August 4, 2025
      </div>
      <div class="my-page-visits">
        <svg class="analytics-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16">
          <path fill="currentColor" d="M3 3v18h18v-2H5V3H3zm14 12l-4-4-4 4-4-4v3l4 4 4-4 4 4v-3z"/>
        </svg>
        <span id="pageViews"></span>
      </div>
      <div class="my-page-tags">
        Tags:
        
          
            <a href="/tags/video" class="tag-link">video</a>, 
            <a href="/tags/web" class="tag-link">web</a>, 
            <a href="/tags/ai" class="tag-link">ai</a>
        
      </div>
      <div class="my-page-content">
        <p>This story started on a Sunday, at the <a href="https://sundai.club/">SundAI Club</a>. Which reminds me, I should post about the fun AI hacks I have been part of at this club since the end of December 2024. Another day!</p>
<h2 id="the-project">The project</h2>
<p>I wanted to create <a href="https://fireship.io">Fireship</a>-styled videos of my friend Andrew&rsquo;s <a href="https://velab.dev/news">AI newsletter</a>. I quickly found out that AI video generation was slighly expensive, and I didn&rsquo;t want to lose much money on this one-day hack.</p>
<h2 id="the-plan">The plan</h2>
<p>Since audio and image generation are relatively inexpensive, I simplified the plan to fit my budget.</p>
<ul>
<li>Generate audio using <a href="https://elevenlabs.io/">ElevenLabs</a></li>
<li>Generate images using <a href="https://openai.com/dall-e/">DALL-E</a></li>
<li>Use the images to create a slideshow</li>
<li>Combine the audio and the slideshow to make a video inside the browser</li>
<li>Allow the user to download the video</li>
</ul>
<p>I knew that making videos inside a web browser was possible, because that&rsquo;s how I think <a href="https://vizzy.io">vizzy.io</a> works. I just needed to do it.</p>
<h2 id="the-hack">The hack</h2>
<p>Getting the audio was the easiest step, ElevenLabs has a great library of voices. Creating the slideshow was also quick, thanks to AI being well-versed in using the HTML Canvas API.
The fun started when I combined the slideshow and the audio. This is where <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder">MediaRecorder</a> came into the picture.
I did manage to combine the audio and the slideshow, and make the video playable in the browser.
However, I couldn&rsquo;t figure out how to make it downloadable. Whatever I had made was good enough for a quick and entertaining demo, and that&rsquo;s all I did on the day of the hack.</p>
<h2 id="the-hard-part">The hard part</h2>
<p>Creating the downloadable file turned out to be the hard part. I asked AI and the internet for troubleshooting tips, but nothing helped. The video was playing fine inside the browser, but the downloaded file was getting truncated to 6 seconds.</p>
<h3 id="the-first-problem">The first problem</h3>
<p>I found out the reason - I had created the audio file by concatenating two mp3 files. The internet recommended against doing this. But I had been splitting and joining mp3 files back in 2002 when I was in college. Because we didn&rsquo;t have CD writers and had to share music over multiple floppy disks. I knew it was fine to concatenate mp3 files, it just worked. Even if it was technically not the best way.</p>
<p>What was happening is that the <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement">AudioElement</a> node which was playing the audio track took the duration from the header of the mp3 file, which belonged to the first part of the concatenated file. And I was stopping the MediaRecorder whenever the <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/ended">ended</a> event was triggered. Hence the video recording was only as long as the first part of the audio file.</p>
<p>I decided it might be too much work trying to figure out the correct length of the audio file. So I put in a fixed duration of 25 seconds for the recording. I also put in a limit of 300 characters for the script, in order to fit in the 25 seconds.</p>
<h3 id="the-second-problem">The second problem</h3>
<p>This change got me past the 6 second limit, but my video was still much shorter than it should have been. I kept on debugging this and every time I was generating new images and audio files. Which meant more and more LLM API calls. I had to make my debugging affordable!</p>
<p>So I created a new mini-project to focus on the problem using two mp3 files which were already present. This mini-project was creating a video file from the audio of the concatenated mp3 files. I could see the same problem still happening. But I did notice another possible reason - the audio was starting to play a little after I called the play() method of the AudioElement node.</p>
<p>It turned out that this is intentional. Audio tracks may not be pre-loaded before play() is called. I found out a load() method on AudioElement, I called it before calling play(), and that seemed to eliminate this problem.</p>
<h3 id="the-last-problem">The last problem</h3>
<p>The final video was still getting truncated. I left my debugging attempts for a few days, until I was at another edition of the SundAI Club. I looked at how MediaRecorder works. It keeps  capturing <a href="https://developer.mozilla.org/en-US/docs/Web/API/Blob">Blob</a> objects and sending them to the <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder/ondataavailable">ondataavailable</a> event handler. For some reason I was getting an incomplete Blob object.</p>
<p>While I was researching about this, I found that someone on the internet claimed to have solved a similar problem by passing a <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder/start#timeslice">timeslice</a> argument to MediaRecorder&rsquo;s start(). This argument is the number of milliseconds to wait before firing a dataavailable event. I passed 1000 as the argument, and I started getting multiple dataavailable events. And I got all the Blob objects for the entire video!</p>
<h2 id="conclusion">Conclusion</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ig0Ycrt5DMU?si=yYmsuohkTbDSdx20" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
<p>I conclude that it is entirely within my ability to create videos using MediaRecorder. Most modern browsers seem to support it. While ffmpeg is a more powerful tool, it will probably cost more money to do it on the cloud.</p>
<p><a href="https://github.com/debamitro/one-minute-bulletin">Here</a> is the source code for the project, and <a href="https://one-minute-bulletin.vercel.app/">here&rsquo;s</a> the live version as of today.</p>

      </div>
      
      <div class="tweet-button-container">
        <div style="float:left">
        <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" 
           class="twitter-share-button" 
           data-text="Making Videos With MediaRecorder" 
           data-via="debamitro" 
           data-hashtags="video,web,ai" 
           data-show-count="false">
          Share on X
        </a>
        </div>
        <div style="float:left; margin-left: 5px">
         <div class="fb-share-button" data-href="https://debamitro.github.io/blog/making-videos-with-media-recorder/" data-layout="button" data-size="small">
          <a target="_blank" 
          href="https://www.facebook.com/sharer/sharer.php?u=https%2f%2fdebamitro.github.io%2fblog%2fmaking-videos-with-media-recorder%2f&amp;src=sdkpreparse" 
          class="fb-xfbml-parse-ignore">
          Share on Facebook
        </a>
        </div>
        </div>
      </div>

    </div>

    <div class="my-bottom-bar">
  Made using <a href="https://gohugo.io" target="_blank">Hugo</a>
  (<a href="https://www.github.com/debamitro/debamitro.github.io/tree/master/src" target="_blank">source</a>)
</div>

  </body>

</html>
